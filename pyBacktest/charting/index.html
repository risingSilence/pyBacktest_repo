<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>M1/Mx Dynamic Viewer – Regime Logic (Anchored)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>

    <link rel="stylesheet" href="style.css" />
    <script src="axis_keyboard.js"></script>
    <script src="crosshair_labels.js"></script>
    <script src="timeframe_keyboard.js"></script>
</head>
<body>

    <h3>M1/Mx Dynamic Viewer (NY Time, Regime Logic, Anchored)</h3>

    <div class="toolbar">
        <div class="toolbar-section">
            <label>
                <input type="checkbox" id="candle-hover-toggle" />
                Candle Info Box
            </label>
            <label style="margin-left:12px;">
                <input type="checkbox" id="show-misses-toggle" checked />
                Show Misses
            </label>
            <label style="margin-left:12px;">
                <input type="checkbox" id="show-signals-toggle" checked />
                Show Signals
            </label>
        </div>

        <div class="toolbar-section">
            <label>View:</label>
            <div id="view-mode">
                <label>
                    <input type="radio" name="view-mode" value="single" checked />
                    One&nbsp;Window
                </label>
                <label>
                    <input type="radio" name="view-mode" value="split" />
                    HTF&nbsp;/&nbsp;LTF
                </label>
            </div>
        </div>

        <div class="toolbar-section">
            <label for="htf-behavior-select" style="font-size:12px; font-weight:bold;">
                HTF behavior:
            </label>
            <select
                id="htf-behavior-select"
                style="font-size:12px; padding:2px 4px; min-width:260px;"
            >
                <option value="independent_snapshots">HTF independent + setup snapshots</option>
                <option value="follow_ltf_snapshots">HTF follows LTF + setup snapshots</option>
                <option value="follow_ltf_strict">HTF follows LTF strictly</option>
            </select>
        </div>


        <div class="toolbar-section">
            <label for="session-days">Session Days:</label>
            <input
                type="number"
                id="session-days"
                min="0"
                max="60"
                value="10"
                style="width: 60px; font-size: 12px; padding: 2px 4px;"
            />
        </div>

        <div class="toolbar-section">
            <div style="display:flex; flex-wrap:wrap; gap:8px;">
                <div>
                    <label for="phase2-file-select" style="font-size:12px; font-weight:bold;">
                        Phase 2 Setups:
                    </label>
                    <select id="phase2-file-select" style="font-size:12px; padding:2px 4px; min-width:220px; max-width:400px;">
                        </select>
                </div>
                <div>
                    <label for="phase3-file-select" style="font-size:12px; font-weight:bold;">
                        Phase 3 Trades:
                    </label>
                    <select id="phase3-file-select" style="font-size:12px; padding:2px 4px; min-width:240px; max-width:400px;">
                        </select>
                </div>

                <div>
                    <label for="setup-select" style="font-size:12px; font-weight:bold;">
                        Setup Selection:
                    </label>
                    <select
                        id="setup-select"
                        style="
                            font-size:12px;
                            padding:2px 4px;
                            min-width:280px;
                            font-family:'Courier New', monospace;
                            white-space:pre;
                        "
                    >
                        </select>
                </div>

                <div>
                    <label for="setup-sort-select" style="font-size:12px; font-weight:bold;">
                        Sorting:
                    </label>
                    <select
                        id="setup-sort-select"
                        style="font-size:12px; padding:2px 4px; min-width:220px;"
                    >
                        <option value="time_asc">Time: Old ↑, New ↓</option>
                        <option value="time_desc">Time: New ↑, Old ↓</option>
                        <option value="dir_long_short">Directional: Longs first</option>
                        <option value="dir_short_long">Directional: Shorts first</option>
                        <option value="r_desc">Winners first</option>
                        <option value="r_asc">Losers first</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div class="hint">
        Mouse wheel = Zoom/Pan (X &amp; Y). Shift + Scroll/Drag = X only. Alt + Scroll/Drag = Y only.
    </div>

    <div id="chart-container" style="display:flex; gap:0;">
        <div id="left-chart-wrapper" style="flex:1 1 50%; display:none; position: relative;">
            <select id="tf-select-left" class="tf-select-overlay" style="left: 65px;"></select>
            <div id="htf-chart" style="height:85vh;"></div>
        </div>

        <div
            id="chart-splitter"
            style="
                flex:0 0 3px;
                cursor: col-resize;
                background: transparent;
                display:none; /* nur im Split-View sichtbar */
            "
        ></div>

        <div id="right-chart-wrapper" style="flex:1 1 100%; position: relative;">
            <select id="tf-select" class="tf-select-overlay" style="left: 15px;"></select>
            <div id="m1-chart" style="height:85vh;"></div>
        </div>
    </div>


    <script src="utils.js"></script>
    <script src="state_manager.js"></script>
    <script src="data_loader.js"></script>
    <script src="view_engine.js"></script>
    <script src="trace_builder.js"></script>
    <script src="chart_renderer.js"></script>
    <script src="ui_controller.js"></script>
    <script src="main.js"></script>
</body>
</html>
